# ICMP Source Quench Check (`icmp_source_quench_check`)

## Opening Scenario

While surveying a utility company’s OT network, a tester sends a deprecated ICMP packet just to see what answers. A legacy router replies to **Source Quench** — a message type retired years ago. That single response tells the team they’re dealing with **obsolete firmware** and likely a wide surface of unpatched vulnerabilities.

## What This Test Is

ICMP **Source Quench** (Type 4) was once intended to signal congestion, asking senders to slow down. It has been **deprecated for many years**; modern hosts and routers should **never** generate it and should **ignore** it if seen.

* **Type 4** — Source Quench (deprecated)

## Why This Matters

* **Legacy indicator:** Any response strongly suggests an outdated network stack or ancient firmware.
* **Security risk:** Legacy devices often lack current patches and may have numerous known vulnerabilities.
* **Operational clue:** Presence of SQ behavior can signal old QoS/congestion assumptions still baked into the environment.

## How It Works

The test sends a Type 4 ICMP packet and watches for **any** ICMP reply.
Modern, compliant systems should not respond at all.
If a reply arrives, the tool records the type/code — the mere fact of a response is the finding.

## Realistic Scenarios

* **Legacy Router Exposure** – A branch office router replies to Source Quench. The team identifies it as an end-of-life platform and prioritizes replacement before proceeding with deeper testing.
* **Industrial Controller Risk** – An ICS gateway acknowledges SQ, confirming a very old TCP/IP stack. The organization isolates that segment and accelerates firmware upgrade plans.

## Defensive Recommendations

* **Block and ignore** ICMP Type 4 on all devices and at network perimeters.
* **Inventory and upgrade** any systems that respond to Source Quench; treat them as high-risk legacy assets.
* **Segment and monitor** legacy equipment until it can be remediated or replaced.
