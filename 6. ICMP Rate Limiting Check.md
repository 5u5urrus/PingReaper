# ICMP Rate Limiting Check (`icmp_rate_limit_check`)

## Opening Scenario

A penetration tester is tasked with assessing a financial services company’s resilience against network scanning and ICMP-based denial-of-service (DoS) attempts. By sending a quick burst of pings, the tester observes that after the first few responses, the target stops replying for several seconds. This behavior confirms that **ICMP rate limiting** is in place — a simple but effective defense against volumetric probing.

## What This Test Is

This check determines whether a host **throttles ICMP replies** when it receives too many requests in a short time.
ICMP rate limiting:

* **Protects against DoS** by reducing processing load.
* **Thwarts fast reconnaissance** that relies on bulk ICMP probing.
* Is common in hardened environments, but absent in many misconfigured or legacy systems.

## Why This Matters

* Without rate limiting, an attacker can **flood a target with ICMP** and cause resource exhaustion.
* High-response ICMP scanning allows attackers to **map networks quickly** without service interaction.
* Rate limiting is part of defense-in-depth against **ping floods, sweeps, and automated recon tools**.

## How It Works

1. **Send a Burst** – The tester transmits a series of ICMP Echo Requests (e.g., 20 packets) in quick succession.
2. **Measure Replies** – The number of responses is compared to the number of requests sent.
3. **Interpret Behavior**:

   * **Low reply count** → Indicates probable ICMP rate limiting.
   * **High reply count** → Suggests no rate limiting is enforced.
4. **Analysis** – A threshold (e.g., <80% responses) is used to flag potential rate limiting.

## Realistic Scenarios

* **ISP Edge Device Protection** – A broadband provider configures all customer gateways to allow only 10 ICMP replies per second. Attackers attempting large-scale scanning receive partial results, slowing recon to a crawl.
* **DoS Mitigation on Public Servers** – A company hosting a public API enforces strict ICMP reply throttling, ensuring ping floods won’t impact application performance.

## Defensive Recommendations

* Enable **ICMP rate limiting** on all internet-facing systems.
* Implement **per-source limits** so attackers can’t monopolize ICMP capacity.
* Monitor logs for **burst ICMP patterns** that could indicate reconnaissance or flood attempts.
* Consider **ICMP shaping** in firewalls or routers to normalize response rates.

