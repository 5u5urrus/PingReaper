## ICMP Router Advertisement Check (`icmp_router_advert_check`)

### Opening Scenario

During a simulated network intrusion, a red team operator sends out crafted ICMP Router Solicitation messages to every host on a subnet. To their surprise, a few critical servers respond with ICMP Router Advertisements — revealing routing information and opening the door for possible man-in-the-middle attacks through rogue router impersonation.

---

### What This Test Is

ICMP Router Solicitation (Type 10) messages are used by hosts to request information from routers. In response, routers may send ICMP Router Advertisement (Type 9) messages containing gateway and network configuration details.

While this is normal in certain dynamic routing or IPv6 neighbor discovery setups, it is uncommon and potentially risky for **end hosts** or sensitive systems to respond.

---

### Why This Matters

* If a host responds to router solicitations, it may leak network topology and routing information to any device on the local segment.
* An attacker could send forged advertisements to nearby hosts, making them route traffic through a malicious machine (**router impersonation / MITM attack**).
* Exposure of router advertisement behavior on servers or endpoints may indicate **misconfigured network stacks** or unnecessary ICMP services enabled.

---

### How It Works

1. The test sends an ICMP Router Solicitation (Type 10) message to the target.
2. A correctly configured **router** might respond with ICMP Router Advertisement (Type 9).
3. If a **non-router host** responds, it may be leaking unnecessary routing information and exposing itself to redirection attacks.

---

### Realistic Scenarios

* **Network Mapping** – An attacker sends solicitations and records router advertisements to build a detailed map of network gateways.
* **MITM Setup** – The attacker injects fake router advertisements, causing victims to route traffic through the attacker’s system.
* **Legacy or Misconfigured Systems** – Older operating systems may respond by default, unknowingly giving away routing data.

---

### Defensive Recommendations

* Ensure only legitimate routers respond to ICMP Router Solicitations.
* On non-router systems, disable ICMP Router Advertisement responses via OS network stack configuration.
* Monitor for unusual ICMP Type 9 or 10 activity on internal networks.
* Use network segmentation and ACLs to restrict who can send/receive these ICMP messages.

